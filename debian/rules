#!/usr/bin/make -f

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/cmake.mk

DEB_STRIP_EXCLUDE := libperl.a
DEB_DH_INSTALL_SOURCEDIR := $(CURDIR)/debian/tmp

ifneq (,$(findstring noopt,$(DEB_BUILD_OPTIONS)))
	CFLAGS += -O0
else
	CFLAGS += -O2
endif

ifeq (,$(findstring nostrip,$(DEB_BUILD_OPTIONS)))
	INSTALL_PROGRAM += -s
endif

DEB_HOST_ARCH_OS := $(shell dpkg-architecture -qDEB_HOST_ARCH_OS)
ifeq ($(DEB_HOST_ARCH_OS),hurd)
	DEB_CONFIGURE_SCRIPT_ENV += LDFLAGS="-lpthread"
endif

install/weechat-core::
	install -D -o root -g root -m 644 debian/weechat.xpm $(CURDIR)/debian/weechat-core/usr/share/pixmaps/weechat.xpm

install/weechat-curses::
	install -D -o root -g root -m 644 debian/lintian-override $(CURDIR)/debian/weechat-curses/usr/share/lintian/overrides/weechat-curses
